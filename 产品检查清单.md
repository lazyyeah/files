| 检查项                           |           |                                               |                               |                                  |
|-------------------------------|-----------|-----------------------------------------------|-------------------------------|----------------------------------|
| 环境缺陷                          | 常见中间件安全测试 | IIS                                           | PUT任意文件写入漏洞                   |                                  |
|                               |           |                                               | 短文件名猜解                        |                                  |
|                               |           |                                               | HTTP.SYS远程代码执行                |                                  |
|                               |           |                                               | 解析漏洞                          |                                  |
|                               |           |                                               | CVE-2017-7269                 |                                  |
|                               |           | Apache                                        | 解析漏洞                          |                                  |
|                               |           |                                               | 目录遍历                          |                                  |
|                               |           | Nginx                                         | 文件解析                          |                                  |
|                               |           |                                               | 目录遍历                          |                                  |
|                               |           |                                               | CRLF注入                        |                                  |
|                               |           |                                               | 目录穿越                          |                                  |
|                               |           |                                               | lua远程代码执行                     |                                  |
|                               |           | Tomcat                                        | 远程代码执行CVE-2019-0232           |                                  |
|                               |           |                                               | 任意文件写入CVE-2017-12615          |                                  |
|                               |           |                                               | WAR后门文件部署                     |                                  |
|                               |           | Jboos                                         | 反序列化代码                        |                                  |
|                               |           |                                               | 远程代码执行                        |                                  |
|                               |           |                                               | war后门文件部署                     |                                  |
|                               |           | Weblogic                                      | 反序列化漏洞                        |                                  |
|                               |           |                                               | SSRF                          |                                  |
|                               |           |                                               | 任意文件上传                        |                                  |
|                               |           |                                               | WAR后门文件部署                     |                                  |
|                               |           | WebSphere                                     | 反序列化漏洞                        |                                  |
|                               |           | Jenkins                                       | 反序列化漏洞                        |                                  |
|                               |           | Struts2                                       |                               |                                  |
|                               |           | thinkphp                                      |                               |                                  |
|                               |           | 建议：使用最新版本，阅读厂商公告查询当前版本是否存在漏洞                  |                               |                                  |
|                               | 第三方库      | "如Fastjson、jackson反序列化漏洞                      |                               |                                  |
| 建议：使用最新版本，阅读厂商公告查询当前版本是否存在漏洞" |           |                                               |                               |                                  |
|                               | 操作系统      | 操作系统弱口令                                       |                               |                                  |
|                               |           | 关闭调试通道                                        |                               |                                  |
|                               |           | 最小化开放端口                                       |                               |                                  |
|                               |           | 操作系统漏洞                                        |                               |                                  |
|                               |           | 最小化用户                                         |                               |                                  |
|                               | 数据库       | 数据库弱口令                                        |                               |                                  |
|                               |           | mangodb未授权访问                                  |                               |                                  |
|                               |           | es未授权访问                                       |                               |                                  |
|                               |           | redis未授权访问                                    |                               |                                  |
|                               |           | MySQL安全问题（弱口令、版本过老、对外暴露端口）                    |                               |                                  |
|                               |           | Oracle                                        |                               |                                  |
|                               |           | 最小化用户权限                                       |                               |                                  |
| 设计缺陷                          | 身份鉴别      | 登陆双因子认证                                       | 建议使用双因子认证                     |                                  |
|                               |           | 登陆控制策略                                        | 统一登录                          | 安全策略一致（加描述）                      |
|                               |           |                                               |                               | 登陆入口一致（加描述）                      |
|                               |           |                                               | 校验失败                          | 密码错误次数限制                         |
|                               |           |                                               |                               | 推荐IP请求错误次数限制                     |
|                               |           |                                               |                               | 提示（建议“用户名或密码错误”，禁止“用户名不存在；密码错误”） |
|                               |           |                                               | 无后门（测试账号），特殊访问通道              |                                  |
|                               |           |                                               | 敏感操作多重认证                      | 充值、转账、提现                         |
|                               |           |                                               | 账户信息安全                        | "密码找回                            |
| 举例"                           |           |                                               |                               |                                  |
|                               |           |                                               |                               | 不能存在信息查询漏洞（查到其他人敏感信息）            |
|                               |           |                                               |                               | 验证逻辑（无用户名枚举、用户密码撞库）              |
|                               |           |                                               | 推建异常登录安全措施（一般锁定账号）            |                                  |
|                               |           |                                               | 登陆token失效                     |                                  |
|                               |           | 短信验证码                                         | 随机生成，5位及以上长度                  |                                  |
|                               |           |                                               | 禁止接口返回验证码值                    |                                  |
|                               |           |                                               | 使用一次性后失效                      |                                  |
|                               |           |                                               | 后台校验                          |                                  |
|                               |           |                                               | 验证码有效期5分钟或更短。使用后失效。           |                                  |
|                               |           |                                               | 推荐错误次数限制                      |                                  |
|                               |           |                                               | 接口访问频率，一个手机60s使用一次。一天5次。      |                                  |
|                               |           |                                               | 建议验证码不通用（如在登录收到的短信验证码不能在修改密码用 |                                  |
|                               |           |                                               | 建议加图片验证码                      |                                  |
|                               |           | 图片验证码                                         | 禁止接口返回验证码值                    |                                  |
|                               |           |                                               | 网页源代码不能出现明文显示验证码值             |                                  |
|                               |           |                                               | 随机生成，长度4位以上（英文+数字）            |                                  |
|                               |           |                                               | 图片干扰线                         |                                  |
|                               |           |                                               | 使用一次性后失效                      |                                  |
|                               |           |                                               | 后台校验                          |                                  |
|                               |           |                                               | 验证码60秒有效期                     |                                  |
|                               |           |                                               | 错误次数限制                        |                                  |
|                               |           | 口令复杂度                                         | 长度至少8位，大小写字母、数字、特殊字符至少两种      |                                  |
|                               |           |                                               | 不能与账号相同                       |                                  |
|                               |           |                                               | 不能有弱口令                        |                                  |
|                               |           |                                               | 密码不能输出到日志和控制台                 |                                  |
|                               |           |                                               | 建议设计密码定期修改提醒                  |                                  |
|                               | 越权        | 未授权访问                                         | 不登陆，不能直接访问下载URL下载文件           |                                  |
|                               |           |                                               | 不能手动修改URL参数访问未授权的页面           |                                  |
|                               |           |                                               | 不登陆，不能直接访问需要登陆态的URL           |                                  |
|                               |           | 垂直越权                                          | 基于URL：低权限用户限制访问高权限用户界面        |                                  |
|                               |           | 水平越权                                          | 基于数据：使用用户身份进行增删改查其他用户操作       |                                  |
|                               | 业务安全      | 业务数据安全                                        | 金融类数据篡改                       |                                  |
|                               |           |                                               | 商品类数据篡改                       |                                  |
|                               |           |                                               | 用户ID篡改                        |                                  |
|                               |           |                                               | 最大最小数限制                       |                                  |
|                               |           | 业务流程安全                                        | 业务流程乱序                        |                                  |
|                               |           |                                               | 业务流程绕过                        |                                  |
|                               |           | 业务接口安全                                        | 重放攻击                          | 短信炸弹                             |
|                               |           |                                               |                               | 邮件炸弹                             |
|                               |           |                                               |                               | 批量新增                             |
|                               |           |                                               |                               | 批量注册                             |
|                               |           |                                               |                               | 批量删除                             |
|                               |           |                                               |                               | 用户枚举                             |
|                               |           |                                               |                               | 密码撞库                             |
|                               |           |                                               |                               | 拒绝服务                             |
|                               |           |                                               | 权限管控                          | 接口调用需要认证权限                       |
|                               |           |                                               | 对输入输出的要求参见编码规范                |                                  |
|                               | 会话安全      | 推荐使用https                                     |                               |                                  |
|                               |           | http方法安全（使用get、post，不使用delete、put等）           |                               |                                  |
|                               |           | cookie、token、session属性                        | 禁止明文存储用户敏感信息                  |                                  |
|                               |           |                                               | 设置有效期                         |                                  |
|                               |           | 用户退出后，清除会话信息                                  |                               |                                  |
|                               | 上传下载      | 不运行不可信文件                                      |                               |                                  |
|                               |           | 不显示下载文件的系统内部路径                                |                               |                                  |
|                               |           | 实例                                            | 文件安全扫描                        |                                  |
|                               |           |                                               | 权限最小                          |                                  |
|                               |           |                                               |                               |                                  |
|                               |           |                                               |                               |                                  |
|                               | 业务日志      | 方便运维人员追踪问题（建议增加）                              |                               |                                  |
|                               | 数据安全      | 数据加密存储                                        |                               |                                  |
|                               |           | 生命周期销毁                                        |                               |                                  |
|                               |           | 重要数据备份                                        |                               |                                  |
| 编码安全规范                        | 输入编码      | 前后端用户输入信息进行校验                                 |                               |                                  |
|                               |           | 前后端对数据类型校验                                    |                               |                                  |
|                               |           | 前后端对数据长度校验                                    |                               |                                  |
|                               |           | 前后端对数据范围校验                                    |                               |                                  |
|                               |           | 设置预期规则                                        |                               |                                  |
|                               | 输出编码      | 所有服务端返回客户端的数据进行编码。如HTML编码、URL编码等。防止输出代码恶意攻击用户 |                               |                                  |
|                               |           | 内部目录禁止返回                                      |                               |                                  |
|                               | 异常处理      | 禁止返回数据库相关报错/路径报错，统一错误页面                       |                               |                                  |
|                               |           | 超时机制，超时后不再等待防止拒绝服务攻击                          |                               |                                  |
|                               | 注入隐患      | SQL注入                                         |                               |                                  |
|                               |           | XSS注入                                         |                               |                                  |
|                               |           | 远程代码执行                                        |                               |                                  |
|                               |           | XML 实体注入检测                                    |                               |                                  |
|                               |           | jsonp 检测                                      |                               |                                  |
|                               |           | ssrf 检测                                       |                               |                                  |
|                               |           | csrf检测                                        |                               |                                  |
|                               | 信息泄露      | 禁止代码中明文存储敏感数据                                 | 数据库地址                         |                                  |
|                               |           |                                               | 口令                            |                                  |
|                               |           |                                               | 密钥                            |                                  |
|                               |           |                                               | 邮箱等                           |                                  |
|                               |           |                                               | 手机号、身份证                       |                                  |
|                               |           | 非授权访问                                         |                               |                                  |
